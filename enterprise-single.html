<head>
  <title>Enterprise Single</title>
  <script src="d3.v3.js" charset="utf-8"></script>
  <link rel="stylesheet" href="style.css" type="text/css"></link>
</head>
<body>
  <!--
    TODO: want to embed these into this - but height/width getting botched
          embedding will allow better use of css in the attributes
  -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" style="display:none">
  <defs>
    <!-- TODO: embeded_images -->
    <g id="user" width="45" height="50">
      <path d="M31.77 31.35C35.78 28.21 39.46 22.68 39.46 17.19 39.46 7.7 31.73 0 22.19 0 12.65 0 4.91 7.7 4.91 17.19 4.91 22.68 8.81 28.32 12.83 31.46 5.63 35.12 0.56 41.57 0 50.02L1.83 50.02C2.44 42.1 7.61 35.47 14.73 32.68 16.99 33.77 19.51 34.39 22.19 34.39 24.87 34.39 27.39 33.77 29.65 32.68 36.77 35.47 41.94 42.1 42.54 50.02L44.38 50.02C43.82 41.57 38.97 35.01 31.77 31.35M22.19 32.57C14.38 32.57 6.74 24.96 6.74 17.19 6.74 9.42 14.38 1.81 22.19 1.81 30 1.81 37.63 9.42 37.63 17.19 37.63 24.96 30 32.57 22.19 32.57Z"/>
    </g>
  </defs>
</svg>
<div id="diagram">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Enterprise Pages: 1 -->
<svg width="631pt" height="361pt"
 viewBox="0.00 0.00 631.00 361.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 357)">
<title>Enterprise</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-357 627,-357 627,4 -4,4"/>
<g id="clust2" class="cluster"><title>cluster_101</title>
<path fill="lightgrey" stroke="black" d="M495,-75C495,-75 603,-75 603,-75 609,-75 615,-81 615,-87 615,-87 615,-333 615,-333 615,-339 609,-345 603,-345 603,-345 495,-345 495,-345 489,-345 483,-339 483,-333 483,-333 483,-87 483,-87 483,-81 489,-75 495,-75"/>
<text text-anchor="middle" x="549" y="-329.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="14.00">Master Appliance</text>
</g>
<g id="clust3" class="cluster"><title>cluster_201</title>
<path fill="lightgrey" stroke="black" d="M63,-75C63,-75 305,-75 305,-75 311,-75 317,-81 317,-87 317,-87 317,-333 317,-333 317,-339 311,-345 305,-345 305,-345 63,-345 63,-345 57,-345 51,-339 51,-333 51,-333 51,-87 51,-87 51,-81 57,-75 63,-75"/>
<text text-anchor="middle" x="184" y="-329.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="14.00">Regional DB Appliance</text>
</g>
<g id="clust5" class="cluster"><title>cluster_202</title>
<path fill="lightgrey" stroke="black" d="M391,-158C391,-158 463,-158 463,-158 469,-158 475,-164 475,-170 475,-170 475,-232 475,-232 475,-238 469,-244 463,-244 463,-244 391,-244 391,-244 385,-244 379,-238 379,-232 379,-232 379,-170 379,-170 379,-164 385,-158 391,-158"/>
<text text-anchor="middle" x="427" y="-228.8" font-family="Helvetica,sans-Serif" font-weight="bold" font-size="14.00">Worker App</text>
</g>
<!-- kdc301 -->
<g id="kdc301" class="node"><title>kdc301</title>
<path fill="#ffffff" stroke="black" stroke-width="2" d="M84,-0.5C84,-0.5 114,-0.5 114,-0.5 120,-0.5 126,-6.5 126,-12.5 126,-12.5 126,-34.5 126,-34.5 126,-40.5 120,-46.5 114,-46.5 114,-46.5 84,-46.5 84,-46.5 78,-46.5 72,-40.5 72,-34.5 72,-34.5 72,-12.5 72,-12.5 72,-6.5 78,-0.5 84,-0.5"/>
<text text-anchor="middle" x="99" y="-31.3" font-family="Helvetica,sans-Serif" font-size="14.00">IdM</text>
<polyline fill="none" stroke="black" stroke-width="2" points="72,-23.5 126,-23.5 "/>
<text text-anchor="middle" x="99" y="-8.3" font-family="Helvetica,sans-Serif" font-size="14.00">kdc</text>
</g>
<!-- ldp301 -->
<g id="ldp301" class="node"><title>ldp301</title>
<path fill="#ffffff" stroke="black" stroke-width="2" d="M12,-0.5C12,-0.5 42,-0.5 42,-0.5 48,-0.5 54,-6.5 54,-12.5 54,-12.5 54,-34.5 54,-34.5 54,-40.5 48,-46.5 42,-46.5 42,-46.5 12,-46.5 12,-46.5 6,-46.5 0,-40.5 0,-34.5 0,-34.5 0,-12.5 0,-12.5 0,-6.5 6,-0.5 12,-0.5"/>
<text text-anchor="middle" x="27" y="-31.3" font-family="Helvetica,sans-Serif" font-size="14.00">IdM</text>
<polyline fill="none" stroke="black" stroke-width="2" points="0,-23.5 54,-23.5 "/>
<text text-anchor="middle" x="27" y="-8.3" font-family="Helvetica,sans-Serif" font-size="14.00">ldap</text>
</g>
<!-- cloud2 -->
<g id="cloud2" class="node"><title>cloud2</title>
<g id="a_cloud2"><a xlink:title="VMWare, OpenStack, Etc">
<polygon fill="none" stroke="none" stroke-width="2" points="486.5,-46.5 405.5,-46.5 405.5,-0.5 486.5,-0.5 486.5,-46.5"/>
<image xlink:href="cloud.svg" width="81px" height="46px" preserveAspectRatio="xMinYMin meet" x="405.5" y="-46.5"/>
<text text-anchor="middle" x="446" y="-19.8" font-family="Helvetica,sans-Serif" font-size="14.00">Provider</text>
</a>
</g>
</g>
<!-- iam1 -->
<g id="iam1" class="node"><title>iam1</title>
<g id="a_iam1"><a xlink:title="Amazon Identitay Access Management">
<polygon fill="none" stroke="none" stroke-width="2" points="387.5,-46.5 306.5,-46.5 306.5,-0.5 387.5,-0.5 387.5,-46.5"/>
<image xlink:href="cloud.svg" width="81px" height="46px" preserveAspectRatio="xMinYMin meet" x="306.5" y="-46.5"/>
<text text-anchor="middle" x="347" y="-27.3" font-family="Helvetica,sans-Serif" font-size="14.00">Amazon</text>
<text text-anchor="middle" x="347" y="-12.3" font-family="Helvetica,sans-Serif" font-size="14.00">IAM</text>
</a>
</g>
</g>
<!-- db101 -->
<g id="db101" class="node"><title>db101</title>
<g id="a_db101"><a xlink:title="Reporting database">
<polygon fill="none" stroke="none" stroke-width="2" points="580,-314 518,-314 518,-252 580,-252 580,-314"/>
<image xlink:href="db.svg" width="62px" height="62px" preserveAspectRatio="xMinYMin meet" x="518" y="-314"/>
<text text-anchor="middle" x="549" y="-279.3" font-family="Helvetica,sans-Serif" font-size="14.00">DB1</text>
</a>
</g>
</g>
<!-- ui101 -->
<g id="ui101" class="node"><title>ui101</title>
<path fill="#ffffff" stroke="black" stroke-width="2" d="M531.5,-166.5C531.5,-166.5 566.5,-166.5 566.5,-166.5 572.5,-166.5 578.5,-172.5 578.5,-178.5 578.5,-178.5 578.5,-200.5 578.5,-200.5 578.5,-206.5 572.5,-212.5 566.5,-212.5 566.5,-212.5 531.5,-212.5 531.5,-212.5 525.5,-212.5 519.5,-206.5 519.5,-200.5 519.5,-200.5 519.5,-178.5 519.5,-178.5 519.5,-172.5 525.5,-166.5 531.5,-166.5"/>
<text text-anchor="middle" x="549" y="-197.3" font-family="Helvetica,sans-Serif" font-size="14.00">UI</text>
<polyline fill="none" stroke="black" stroke-width="2" points="519.5,-189.5 578.5,-189.5 "/>
<text text-anchor="middle" x="549" y="-174.3" font-family="Helvetica,sans-Serif" font-size="14.00">worker</text>
</g>
<!-- db101&#45;&gt;ui101 -->
<g id="edge1" class="edge"><title>db101:s&#45;&gt;ui101:n</title>
<g id="a_edge1"><a xlink:title="access via localhost | client:ui101 | server:db101 | config:ui101:database.yml">
<path fill="none" stroke="black" d="M549,-246.812C549,-233.8 549,-228.74 549,-213.5"/>
<polygon fill="black" stroke="black" points="547.25,-247 549,-252 550.75,-247 547.25,-247"/>
</a>
</g>
</g>
<!-- rep201 -->
<g id="rep201" class="node"><title>rep201</title>
<g id="a_rep201"><a xlink:title="Ruby replication worker | config:ui201">
<path fill="#ffffff" stroke="black" stroke-width="2" d="M255.5,-260C255.5,-260 296.5,-260 296.5,-260 302.5,-260 308.5,-266 308.5,-272 308.5,-272 308.5,-294 308.5,-294 308.5,-300 302.5,-306 296.5,-306 296.5,-306 255.5,-306 255.5,-306 249.5,-306 243.5,-300 243.5,-294 243.5,-294 243.5,-272 243.5,-272 243.5,-266 249.5,-260 255.5,-260"/>
<text text-anchor="middle" x="276" y="-290.8" font-family="Helvetica,sans-Serif" font-size="14.00">db sync</text>
<polyline fill="none" stroke="black" stroke-width="2" points="243.5,-283 308.5,-283 "/>
<text text-anchor="middle" x="276" y="-267.8" font-family="Helvetica,sans-Serif" font-size="14.00">worker</text>
</a>
</g>
</g>
<!-- db101&#45;&gt;rep201 -->
<g id="edge10" class="edge"><title>db101&#45;&gt;rep201</title>
<g id="a_edge10"><a xlink:title="password from vmdb.yml access | client:rep201:vmdb.yml | client:rep201:v2_key | server:db201:pg_shadow | client&#45;config:ui201 | server&#45;config:con101">
<path fill="none" stroke="black" d="M512.225,-283C444.325,-283 376.425,-283 308.525,-283"/>
<polygon fill="black" stroke="black" points="512.532,-284.75 517.532,-283 512.532,-281.25 512.532,-284.75"/>
</a>
</g>
</g>
<!-- ap101 -->
<g id="ap101" class="node"><title>ap101</title>
<g id="a_ap101"><a xlink:title="proxy">
<path fill="#ffffff" stroke="black" stroke-width="2" d="M530,-83.5C530,-83.5 568,-83.5 568,-83.5 574,-83.5 580,-89.5 580,-95.5 580,-95.5 580,-117.5 580,-117.5 580,-123.5 574,-129.5 568,-129.5 568,-129.5 530,-129.5 530,-129.5 524,-129.5 518,-123.5 518,-117.5 518,-117.5 518,-95.5 518,-95.5 518,-89.5 524,-83.5 530,-83.5"/>
<text text-anchor="middle" x="549" y="-114.3" font-family="Helvetica,sans-Serif" font-size="14.00">apache</text>
<polyline fill="none" stroke="black" stroke-width="2" points="518,-106.5 580,-106.5 "/>
<text text-anchor="middle" x="549" y="-91.3" font-family="Helvetica,sans-Serif" font-size="14.00">auth...</text>
</a>
</g>
</g>
<!-- ui101&#45;&gt;ap101 -->
<g id="edge2" class="edge"><title>ui101&#45;&gt;ap101</title>
<g id="a_edge2"><a xlink:title="access via localhost | client:ap101 | server:ui101">
<path fill="none" stroke="black" d="M549,-161.129C549,-150.864 549,-139.336 549,-129.607"/>
<polygon fill="black" stroke="black" points="547.25,-161.366 549,-166.366 550.75,-161.366 547.25,-161.366"/>
</a>
</g>
</g>
<!-- ui201 -->
<g id="ui201" class="node"><title>ui201</title>
<path fill="#ffffff" stroke="black" stroke-width="2" d="M143.5,-166.5C143.5,-166.5 178.5,-166.5 178.5,-166.5 184.5,-166.5 190.5,-172.5 190.5,-178.5 190.5,-178.5 190.5,-200.5 190.5,-200.5 190.5,-206.5 184.5,-212.5 178.5,-212.5 178.5,-212.5 143.5,-212.5 143.5,-212.5 137.5,-212.5 131.5,-206.5 131.5,-200.5 131.5,-200.5 131.5,-178.5 131.5,-178.5 131.5,-172.5 137.5,-166.5 143.5,-166.5"/>
<text text-anchor="middle" x="161" y="-197.3" font-family="Helvetica,sans-Serif" font-size="14.00">UI</text>
<polyline fill="none" stroke="black" stroke-width="2" points="131.5,-189.5 190.5,-189.5 "/>
<text text-anchor="middle" x="161" y="-174.3" font-family="Helvetica,sans-Serif" font-size="14.00">worker</text>
</g>
<!-- ui101&#45;&gt;ui201 -->
<g id="edge11" class="edge"><title>ui101:w&#45;&gt;ui201:e</title>
<g id="a_edge11"><a xlink:title="password access | client:file:v2_key | server:file:v2_key">
<path fill="none" stroke="black" d="M513.519,-191.758C503.509,-201.849 495.679,-242.551 470,-248 455.762,-251.022 222.238,-251.022 208,-248 203.718,-247.091 201.615,-247.511 199,-244 192.846,-235.737 200.786,-202.619 196.083,-192.471"/>
<polygon fill="black" stroke="black" points="514.322,-193.313 518,-189.5 512.747,-190.187 514.322,-193.313"/>
<polygon fill="black" stroke="black" points="197.073,-191.026 192,-189.5 195.014,-193.857 197.073,-191.026"/>
</a>
</g>
</g>
<!-- usera -->
<g id="usera" class="node"><title>usera</title>
<g id="a_usera"><a xlink:title="Admin with Password">
<polygon fill="none" stroke="none" stroke-width="2" points="567,-41.5 531,-41.5 531,-5.5 567,-5.5 567,-41.5"/>
<image xlink:href="user.svg" width="36px" height="36px" preserveAspectRatio="xMinYMin meet" x="531" y="-41.5"/>
<text text-anchor="middle" x="549" y="-8.5" font-family="Helvetica,sans-Serif" font-size="10.00">Admin</text>
</a>
</g>
</g>
<!-- ap101&#45;&gt;usera -->
<g id="edge13" class="edge"><title>ap101:s&#45;&gt;usera:n</title>
<g id="a_edge13"><a xlink:title="password from user, passthrough | client:usera:password | server:db101:users | server&#45;config:con101">
<path fill="none" stroke="black" d="M549,-77.468C549,-63.6819 549,-58.4722 549,-42.5"/>
<polygon fill="black" stroke="black" points="547.25,-77.5 549,-82.5 550.75,-77.5 547.25,-77.5"/>
</a>
</g>
</g>
<!-- db201 -->
<g id="db201" class="node"><title>db201</title>
<g id="a_db201"><a xlink:title="Regional database | config:con201">
<polygon fill="none" stroke="none" stroke-width="2" points="225,-314 163,-314 163,-252 225,-252 225,-314"/>
<image xlink:href="db.svg" width="62px" height="62px" preserveAspectRatio="xMinYMin meet" x="163" y="-314"/>
<text text-anchor="middle" x="194" y="-279.3" font-family="Helvetica,sans-Serif" font-size="14.00">DB2</text>
</a>
</g>
</g>
<!-- rep201&#45;&gt;db201 -->
<g id="edge9" class="edge"><title>rep201&#45;&gt;db201</title>
<g id="a_edge9"><a xlink:title="Replication to local database | access:localhost | client:rep201:database.yml | server:db201:pg_shadow | client&#45;config:con201">
<path fill="none" stroke="black" d="M243.373,-283C238.988,-283 234.603,-283 230.218,-283"/>
<polygon fill="black" stroke="black" points="230.07,-281.25 225.07,-283 230.07,-284.75 230.07,-281.25"/>
</a>
</g>
</g>
<!-- db201&#45;&gt;ui201 -->
<g id="edge3" class="edge"><title>db201:s&#45;&gt;ui201:n</title>
<g id="a_edge3"><a xlink:title="Stores Business data, User Identity, db identity | access:localhost | client:ui201:database.yml | server:db201:pg_shadow | client&#45;config:con201 | server&#45;config:con201">
<path fill="none" stroke="black" d="M193.311,-246.798C188.572,-230.378 161,-234.1 161,-213.5"/>
<polygon fill="black" stroke="black" points="191.608,-247.273 194,-252 195.078,-246.813 191.608,-247.273"/>
</a>
</g>
</g>
<!-- wk202a -->
<g id="wk202a" class="node"><title>wk202a</title>
<path fill="#ffffff" stroke="black" stroke-width="2" d="M402.5,-166.5C402.5,-166.5 451.5,-166.5 451.5,-166.5 457.5,-166.5 463.5,-172.5 463.5,-178.5 463.5,-178.5 463.5,-200.5 463.5,-200.5 463.5,-206.5 457.5,-212.5 451.5,-212.5 451.5,-212.5 402.5,-212.5 402.5,-212.5 396.5,-212.5 390.5,-206.5 390.5,-200.5 390.5,-200.5 390.5,-178.5 390.5,-178.5 390.5,-172.5 396.5,-166.5 402.5,-166.5"/>
<text text-anchor="middle" x="427" y="-197.3" font-family="Helvetica,sans-Serif" font-size="14.00">inventory</text>
<polyline fill="none" stroke="black" stroke-width="2" points="390.5,-189.5 463.5,-189.5 "/>
<text text-anchor="middle" x="427" y="-174.3" font-family="Helvetica,sans-Serif" font-size="14.00">worker</text>
</g>
<!-- db201&#45;&gt;wk202a -->
<g id="edge12" class="edge"><title>db201:s&#45;&gt;wk202a</title>
<g id="a_edge12"><a xlink:title="client:wk202a:database.yml | server:db201:pg_shadow | client&#45;config:con201">
<path fill="none" stroke="black" d="M197.533,-248.283C216.802,-239.787 308.794,-247.315 321,-244 346.066,-237.193 372.136,-224.127 392.149,-212.611"/>
<polygon fill="black" stroke="black" points="196.176,-247.17 194,-252 198.713,-249.581 196.176,-247.17"/>
</a>
</g>
</g>
<!-- mem201 -->
<g id="mem201" class="node"><title>mem201</title>
<path fill="#ffffff" stroke="black" stroke-width="2" d="M71.5,-260C71.5,-260 132.5,-260 132.5,-260 138.5,-260 144.5,-266 144.5,-272 144.5,-272 144.5,-294 144.5,-294 144.5,-300 138.5,-306 132.5,-306 132.5,-306 71.5,-306 71.5,-306 65.5,-306 59.5,-300 59.5,-294 59.5,-294 59.5,-272 59.5,-272 59.5,-266 65.5,-260 71.5,-260"/>
<text text-anchor="middle" x="102" y="-290.8" font-family="Helvetica,sans-Serif" font-size="14.00">memcache</text>
<polyline fill="none" stroke="black" stroke-width="2" points="59.5,-283 144.5,-283 "/>
<text text-anchor="middle" x="102" y="-267.8" font-family="Helvetica,sans-Serif" font-size="14.00">session</text>
</g>
<!-- mem201&#45;&gt;ui201 -->
<g id="edge5" class="edge"><title>mem201:s&#45;&gt;ui201:n</title>
<g id="a_edge5"><a xlink:title="access:localhost | client:ui201 | server:mem201">
<path fill="none" stroke="black" d="M102.584,-253.712C108.712,-228.13 161,-244.674 161,-213.5"/>
<polygon fill="black" stroke="black" points="100.809,-253.838 102,-259 104.288,-254.222 100.809,-253.838"/>
</a>
</g>
</g>
<!-- pam201 -->
<g id="pam201" class="node"><title>pam201</title>
<g id="a_pam201"><a xlink:title="Security Services | config:con201">
<path fill="#ffffff" stroke="black" stroke-width="2" d="M71,-83.5C71,-83.5 101,-83.5 101,-83.5 107,-83.5 113,-89.5 113,-95.5 113,-95.5 113,-117.5 113,-117.5 113,-123.5 107,-129.5 101,-129.5 101,-129.5 71,-129.5 71,-129.5 65,-129.5 59,-123.5 59,-117.5 59,-117.5 59,-95.5 59,-95.5 59,-89.5 65,-83.5 71,-83.5"/>
<text text-anchor="middle" x="86" y="-114.3" font-family="Helvetica,sans-Serif" font-size="14.00">pam</text>
<polyline fill="none" stroke="black" stroke-width="2" points="59,-106.5 113,-106.5 "/>
<text text-anchor="middle" x="86" y="-91.3" font-family="Helvetica,sans-Serif" font-size="14.00">sssd</text>
</a>
</g>
</g>
<!-- pam201&#45;&gt;ldp301 -->
<g id="edge22" class="edge"><title>pam201&#45;&gt;ldp301</title>
<g id="a_edge22"><a xlink:title="password | client:pam201 | server:ldp301 ">
<path fill="none" stroke="black" d="M69.878,-83.3664C62.5286,-73.2765 53.7737,-61.2572 46.0969,-50.7177"/>
<polygon fill="black" stroke="black" points="47.4609,-49.618 43.1025,-46.6068 44.6318,-51.6787 47.4609,-49.618"/>
</a>
</g>
</g>
<!-- ui201&#45;&gt;ldp301 -->
<g id="edge21" class="edge"><title>ui201&#45;&gt;ldp301</title>
<g id="a_edge21"><a xlink:title="ruby ldap code | client:ui201:vmdb.yml | client:ui201:v2_key | client&#45;config:ui201 | server:ldp301">
<path fill="none" stroke="black" d="M131.351,-180.594C105.883,-172.243 70.1754,-156.528 50,-130 32.8033,-107.389 27.9065,-74.5791 26.7735,-51.5683"/>
<polygon fill="black" stroke="black" points="28.5204,-51.4523 26.5773,-46.5241 25.023,-51.5884 28.5204,-51.4523"/>
</a>
</g>
</g>
<!-- ui201&#45;&gt;iam1 -->
<g id="edge18" class="edge"><title>ui201&#45;&gt;iam1</title>
<g id="a_edge18"><a xlink:title="password from db101 | client:db201:authentications | client&#45;config:ui201 | server:iam1">
<path fill="none" stroke="black" d="M186.358,-166.305C190.435,-163.288 194.724,-160.406 199,-158 230.735,-140.142 247.313,-152.43 276,-130 302.904,-108.964 323.217,-74.8305 335.082,-51.108"/>
<polygon fill="black" stroke="black" points="336.708,-51.7686 337.342,-46.5093 333.566,-50.225 336.708,-51.7686"/>
</a>
</g>
</g>
<!-- ap201 -->
<g id="ap201" class="node"><title>ap201</title>
<path fill="#ffffff" stroke="black" stroke-width="2" d="M143,-83.5C143,-83.5 181,-83.5 181,-83.5 187,-83.5 193,-89.5 193,-95.5 193,-95.5 193,-117.5 193,-117.5 193,-123.5 187,-129.5 181,-129.5 181,-129.5 143,-129.5 143,-129.5 137,-129.5 131,-123.5 131,-117.5 131,-117.5 131,-95.5 131,-95.5 131,-89.5 137,-83.5 143,-83.5"/>
<text text-anchor="middle" x="162" y="-114.3" font-family="Helvetica,sans-Serif" font-size="14.00">apache</text>
<polyline fill="none" stroke="black" stroke-width="2" points="131,-106.5 193,-106.5 "/>
<text text-anchor="middle" x="162" y="-91.3" font-family="Helvetica,sans-Serif" font-size="14.00">auth?</text>
</g>
<!-- ui201&#45;&gt;ap201 -->
<g id="edge4" class="edge"><title>ui201:s&#45;&gt;ap201:n</title>
<g id="a_edge4"><a xlink:title="mod_proxy connection | access:localhost | client:ap201 | server:ui201">
<path fill="none" stroke="black" d="M161.038,-160.401C161.221,-148.632 162,-143.934 162,-130"/>
<polygon fill="black" stroke="black" points="159.287,-160.487 161,-165.5 162.787,-160.513 159.287,-160.487"/>
</a>
</g>
</g>
<!-- con201 -->
<g id="con201" class="node"><title>con201</title>
<path fill="#ffffff" stroke="black" stroke-width="2" d="M220.5,-166.5C220.5,-166.5 261.5,-166.5 261.5,-166.5 267.5,-166.5 273.5,-172.5 273.5,-178.5 273.5,-178.5 273.5,-200.5 273.5,-200.5 273.5,-206.5 267.5,-212.5 261.5,-212.5 261.5,-212.5 220.5,-212.5 220.5,-212.5 214.5,-212.5 208.5,-206.5 208.5,-200.5 208.5,-200.5 208.5,-178.5 208.5,-178.5 208.5,-172.5 214.5,-166.5 220.5,-166.5"/>
<text text-anchor="middle" x="241" y="-197.3" font-family="Helvetica,sans-Serif" font-size="14.00">console</text>
<polyline fill="none" stroke="black" stroke-width="2" points="208.5,-189.5 273.5,-189.5 "/>
<text text-anchor="middle" x="241" y="-174.3" font-family="Helvetica,sans-Serif" font-size="14.00">rake,cli</text>
</g>
<!-- ssh201 -->
<g id="ssh201" class="node"><title>ssh201</title>
<path fill="#ffffff" stroke="black" stroke-width="2" d="M225,-88.5C225,-88.5 255,-88.5 255,-88.5 261,-88.5 267,-94.5 267,-100.5 267,-100.5 267,-112.5 267,-112.5 267,-118.5 261,-124.5 255,-124.5 255,-124.5 225,-124.5 225,-124.5 219,-124.5 213,-118.5 213,-112.5 213,-112.5 213,-100.5 213,-100.5 213,-94.5 219,-88.5 225,-88.5"/>
<text text-anchor="middle" x="240" y="-102.8" font-family="Helvetica,sans-Serif" font-size="14.00">ssh</text>
</g>
<!-- con201&#45;&gt;ssh201 -->
<g id="edge6" class="edge"><title>con201:s&#45;&gt;ssh201:n</title>
<g id="a_edge6"><a xlink:title="access:localhost | client:ssh201 | server:con201">
<path fill="none" stroke="black" d="M240.971,-160.467C240.807,-146.678 240,-141.477 240,-125.5"/>
<polygon fill="black" stroke="black" points="239.221,-160.51 241,-165.5 242.721,-160.49 239.221,-160.51"/>
</a>
</g>
</g>
<!-- ap201&#45;&gt;kdc301 -->
<g id="edge20" class="edge"><title>ap201&#45;&gt;kdc301</title>
<g id="a_edge20"><a xlink:title="client:ap201:keytab | client&#45;config:con201:ipa&#45;config | server:kdc201">
<path fill="none" stroke="black" d="M144.785,-83.3664C136.937,-73.2765 127.589,-61.2572 119.392,-50.7177"/>
<polygon fill="black" stroke="black" points="120.645,-49.4792 116.194,-46.6068 117.883,-51.628 120.645,-49.4792"/>
</a>
</g>
</g>
<!-- ap201&#45;&gt;pam201 -->
<g id="edge7" class="edge"><title>ap201&#45;&gt;pam201</title>
<g id="a_edge7"><a xlink:title="access:localhost client:pam201 server:ap201">
<path fill="none" stroke="black" d="M130.619,-106.5C126.494,-106.5 122.368,-106.5 118.242,-106.5"/>
<polygon fill="black" stroke="black" points="118.016,-104.75 113.016,-106.5 118.016,-108.25 118.016,-104.75"/>
</a>
</g>
</g>
<!-- userp -->
<g id="userp" class="node"><title>userp</title>
<g id="a_userp"><a xlink:title="User with Password">
<polygon fill="none" stroke="none" stroke-width="2" points="234,-41.5 198,-41.5 198,-5.5 234,-5.5 234,-41.5"/>
<image xlink:href="user.svg" width="36px" height="36px" preserveAspectRatio="xMinYMin meet" x="198" y="-41.5"/>
<text text-anchor="middle" x="216" y="-8.5" font-family="Helvetica,sans-Serif" font-size="10.00">pass</text>
</a>
</g>
</g>
<!-- ap201&#45;&gt;userp -->
<g id="edge14" class="edge"><title>ap201:s&#45;&gt;userp:n</title>
<g id="a_edge14"><a xlink:title="password from user, passthrough rails logs | client:userp:password | server:db201:users">
<path fill="none" stroke="black" d="M162.606,-77.4569C168.539,-54.9058 216,-70.5005 216,-42.5"/>
<polygon fill="black" stroke="black" points="160.86,-77.3268 162,-82.5 164.335,-77.7447 160.86,-77.3268"/>
</a>
</g>
</g>
<!-- userk -->
<g id="userk" class="node"><title>userk</title>
<g id="a_userk"><a xlink:title="User With Kerberos Ticket">
<polygon fill="none" stroke="none" stroke-width="2" points="180,-41.5 144,-41.5 144,-5.5 180,-5.5 180,-41.5"/>
<image xlink:href="user.svg" width="36px" height="36px" preserveAspectRatio="xMinYMin meet" x="144" y="-41.5"/>
<text text-anchor="middle" x="162" y="-8.5" font-family="Helvetica,sans-Serif" font-size="10.00">sso</text>
</a>
</g>
</g>
<!-- ap201&#45;&gt;userk -->
<g id="edge15" class="edge"><title>ap201:s&#45;&gt;userk:n</title>
<g id="a_edge15"><a xlink:title="server config uses ipa&#45;config | client:file:keytab | server:pam201 | client&#45;config:kdc301:kinit | server&#45;config:con201">
<path fill="none" stroke="black" d="M162,-77.468C162,-63.6819 162,-58.4722 162,-42.5"/>
<polygon fill="black" stroke="black" points="160.25,-77.5 162,-82.5 163.75,-77.5 160.25,-77.5"/>
</a>
</g>
</g>
<!-- ssh201&#45;&gt;pam201 -->
<g id="edge8" class="edge"><title>ssh201&#45;&gt;pam201</title>
<g id="a_edge8"><a xlink:title="access:localhost client:pam201 server:ssh201">
<path fill="none" stroke="black" d="M223.027,-124.685C214.781,-132.202 204.232,-140.068 193,-144 166.992,-153.104 156.91,-153.381 131,-144 124.163,-141.525 117.635,-137.507 111.776,-133.001"/>
<polygon fill="black" stroke="black" points="112.822,-131.596 107.832,-129.817 110.623,-134.319 112.822,-131.596"/>
</a>
</g>
</g>
<!-- ssh201&#45;&gt;userp -->
<g id="edge16" class="edge"><title>ssh201:s&#45;&gt;userp:n</title>
<g id="a_edge16"><a xlink:title="password from user | client:userp:password | server:ssh201:/etc/passwd">
<path fill="none" stroke="black" d="M239.499,-82.1366C236.052,-64.7208 216,-63.2188 216,-42.5"/>
<polygon fill="black" stroke="black" points="237.792,-82.6846 240,-87.5 241.277,-82.3588 237.792,-82.6846"/>
</a>
</g>
</g>
<!-- userc -->
<g id="userc" class="node"><title>userc</title>
<g id="a_userc"><a xlink:title="User With SSL Cert">
<polygon fill="none" stroke="none" stroke-width="2" points="288,-41.5 252,-41.5 252,-5.5 288,-5.5 288,-41.5"/>
<image xlink:href="user.svg" width="36px" height="36px" preserveAspectRatio="xMinYMin meet" x="252" y="-41.5"/>
<text text-anchor="middle" x="270" y="-8.5" font-family="Helvetica,sans-Serif" font-size="10.00">ssl</text>
</a>
</g>
</g>
<!-- ssh201&#45;&gt;userc -->
<g id="edge17" class="edge"><title>ssh201:s&#45;&gt;userc:n</title>
<g id="a_edge17"><a xlink:title="client:userc:id_rsa | server:ssh201:id_rsa.pub | client&#45;config:userc:ssh&#45;keygen | server&#45;config:userc:ssh&#45;copy&#45;id">
<path fill="none" stroke="black" d="M240.521,-82.3369C244.504,-63.7778 270,-64.6591 270,-42.5"/>
<polygon fill="black" stroke="black" points="238.761,-82.3496 240,-87.5 242.243,-82.7009 238.761,-82.3496"/>
</a>
</g>
</g>
<!-- wk202a&#45;&gt;cloud2 -->
<g id="edge19" class="edge"><title>wk202a&#45;&gt;cloud2</title>
<g id="a_edge19"><a xlink:title="password stored in database and decoded with v2_key | client:db101:authentications | client:wk202a:v2_key | server:cloud2:password">
<path fill="none" stroke="black" d="M429.562,-166.382C433.014,-136.588 439.153,-83.6033 442.872,-51.4957"/>
<polygon fill="black" stroke="black" points="444.611,-51.6968 443.448,-46.5286 441.134,-51.294 444.611,-51.6968"/>
</a>
</g>
</g>
<!-- userk&#45;&gt;kdc301 -->
<g id="edge23" class="edge"><title>userk&#45;&gt;kdc301</title>
<g id="a_edge23"><a xlink:title="ticket from kerberos | client:userp:password | client&#45;config:userp:kinit">
<path fill="none" stroke="black" d="M143.754,-23.5C139.61,-23.5 135.465,-23.5 131.32,-23.5"/>
<polygon fill="black" stroke="black" points="131.07,-21.7501 126.07,-23.5 131.07,-25.2501 131.07,-21.7501"/>
</a>
</g>
</g>
</g>
</svg>

</div>
<div id="desc-wrap">
  <div id="desc">
    <div class="src-dest"></div>
    <div class="active"></div>
  </div>
</div>
<script>
/* selecting an edge is difficult */
/* instead of relying upon mouseover/mouseout, having mouseover sticky */

var current_edge = {};

function markClass(id, className, enabled) {
  if (id && className) {
    d3.select("#"+id).classed(className, enabled)
  }
}

function displayRelations(datum, nodeClass, enabled) {
  if (!datum)
    return;
  markClass(datum.id, nodeClass, enabled);
  for(var n in datum) {
    if(n != "desc" && n != "id") {
      markClass(datum[n], n, enabled)
    }
  }
  var desc = enabled ? (datum.desc || "") : "";
  d3.select("#desc ."+nodeClass).html(desc);
}

function extractDatum(node, datum) {
  var info = d3.select(node).select("a")
  if (info && info[0] && info[0][0]) {
    info = info.attr("xlink:title");
  } else {
    info = null;
  }
  if (info) {
    var attrs = info.split("|")
    // class:id:filename - class = (config|client|server|client_config|server_config)
    for(var attr_num = 0; attr_num < attrs.length ; attr_num++) {
      var attr = attrs[attr_num].trim();
      attr_parts = attr.split(":")
      if (attr_parts[1]) {
        // TODO: handle duplicate attributes?
        datum[attr_parts[0]] = attr_parts[1];
        // TODO: add specific support for 3rd parameter (tablename/filename)
        // if (attr_parts[2])
        //   attr["filename"] = attr_parts[2];
      } else {
        datum["desc"] = attr_parts[0];
      }
    }
  }
  return datum;
}

/* work around dot not supporting attribute `class="x"` */
function hackClass(node, datum) {
  if (datum["class"]) {
    d3.select(node).classed(datum["class"], true);
    delete datum["class"];
  }
  return datum;
}

d3.selectAll(".node").datum(function() {
  return hackClass(this, extractDatum(this, {"id" : this.id}));
})
.on('mouseover', function(datum) {
  displayRelations(datum, 'active', true)
})
.on('mouseout', function(datum) {
  displayRelations(datum, 'active', false)
});

d3.selectAll(".edge").datum(function(){
  return extractDatum(this, {"id" : this.id});
})
.on('mouseover', function(datum) {
/*  since it is hard to select a line using mouseover/mouseout,
 *   implementing mouseover with logic of both
 */
  if (datum.id != current_edge.id) {
    displayRelations(current_edge, 'src-dest', false);
    current_edge = datum;
    displayRelations(datum, 'src-dest', true);
  }
}); 
</script>
</body>
